

# 详细描述域名系统协议、文件传送协议、动态主机配置协议

### 1.域名系统协议DNS

域名系统协议概念：

大多数情况下DNS 使用 UDP 进行传输：

使用 TCP 进行传输的两种情况：

两个查询：

（1）递归查询：
（2）迭代查询：

### 2.文件传送协议FTP

文件传输协议概念：

两个连接：

控制连接：
数据连接：

FTP 有主动和被动两种模式：

主动模式：
被动模式：

### 3.动态主机配置协议

DHCP概念：

DHCP 工作过程如下：

1、

2、

3、

4、

































































# 详细描述域名系统协议、文件传送协议、动态主机配置协议

# 1.域名系统协议

域名系统协议概念：是一种分布式网络目录服务，主要用于域名与 IP 地址的相互转换，以及控制因特网的电子邮件的发送。 DNS 可以使用 UDP 或者 TCP 进行传输，使用的端口号都为 53。

大多数情况下DNS 使用 UDP 进行传输，这就要求域名解析器和域名服务器都必须自己处理超时和重传来保证可靠性。

使用 TCP 进行传输的两种情况：

如果返回的响应超过的 512 字节就改用 TCP 进行传输（UDP 最大只支持 512字节的数据）；
区域传送需要使用 TCP 进行传输（区域传送是主域名服务器向辅助域名服务器传送变化的那部分数据） 。

两个查询：

（1）递归查询：本机向本地域名服务器发出一次查询请求，就静待最终的结果。如果本地域名服务器无法解析，自己会以DNS客户机的身份向其它域名服务器查询，直到得到最终的IP地址告诉本机 
（2）迭代查询：本地域名服务器向根域名服务器查询，根域名服务器告诉它下一步到哪里去查询，然后它再去查，每次它都是以客户机的身份去各个服务器查询。







2.文件传送协议FTP

文件传输协议概念：是用于在网络上进行文件传输的一套标准协议，它工作应用层。

两个连接：连接FTP使用 TCP 进行连接，它需要两个连接来传送一个文件：

控制连接：服务器打开端口号 21 等待客户端的连接，客户端主动建立连接后，使用这个连接将客户端的命令传送给服务器，并传回服务器的应答。
数据连接：用来传送一个文件数据。

FTP 有主动和被动两种模式：

主动模式：服务器端主动建立数据连接，其中服务器端的端口号为 20，客户端的端口号随机，但是必须大于 1024，因为 0~1023 是熟知端口号。
被动模式：客户端主动建立数据连接，其中客户端的端口号由客户端自己指定，服务器端的端口号随机。
主动模式要求客户端开放端口号给服务器端，需要去配置客户端的防火墙。

被动模式只需要服务器端开放端口号即可，无需客户端配置防火墙。但是被动模式会导致服务器端的安全性减弱，因为开放了过多的端口号。



3.动态主机配置协议

DHCP概念：DHCP（动态主机配置协议）是一个局域网的网络协议。DHCP 提供了即插即用的连网方式，用户不再需要去手动配置 IP 地址等信息。DHCP 配置的内容不仅是 IP 地址，还包括子网掩码、网关 IP 地址。

DHCP 工作过程如下：

客户端发送 Discover 报文，该报文的目的地址为 255.255.255.255:67，源地址为 0.0.0.0:68，被放入 UDP 中，该报文被广播到同一个子网的所有主机上。如果客户端和 DHCP 服务器不在同一个子网，就需要使用中继代理。
DHCP 服务器收到 Discover 报文之后，发送 Offer 报文给客户端，该报文包含了客户端所需要的信息。因为客户端可能收到多个 DHCP 服务器提供的信息，因此客户端需要进行选择。
如果客户端选择了某个 DHCP 服务器提供的信息，那么就发送 Request 报文给该 DHCP 服务器。
DHCP 服务器发送 Ack 报文，表示客户端此时可以使用提供给它的信息。



